<!DOCTYPE html>
<html lang="en">
<!-- Redolence/checkout.html  22 Nov 2019 09:55:06 GMT -->

<head>
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
	<title>Redolence - Bootstrap eCommerce Template</title>
	<meta name="keywords" content="HTML5 Template" />
	<meta name="description" content="Redolence - Bootstrap eCommerce Template" />
	<meta name="author" content="p-themes" />
	<!-- Favicon -->
	<link rel="apple-touch-icon" sizes="180x180" href="user/assets/images/icons/apple-touch-icon.png" />
	<link rel="icon" type="image/png" sizes="32x32" href="user/assets/images/icons/favicon-32x32.png" />
	<link rel="icon" type="image/png" sizes="16x16" href="user/assets/images/icons/favicon-16x16.png" />
	<link rel="manifest" href="user/assets/images/icons/site.html" />
	<link rel="mask-icon" href="user/assets/images/icons/safari-pinned-tab.svg" color="#666666" />
	<link rel="shortcut icon" href="user/assets/images/icons/favicon.ico" />
	<meta name="apple-mobile-web-app-title" content="Redolence" />
	<meta name="application-name" content="Redolence" />
	<meta name="msapplication-TileColor" content="#cc9966" />
	<meta name="msapplication-config" content="user/assets/images/icons/browserconfig.xml" />
	<meta name="theme-color" content="#ffffff" />
	<!-- Plugins CSS File -->
	<link rel="stylesheet" href="user/assets/css/bootstrap.min.css" />
	<!-- Main CSS File -->
	<link rel="stylesheet" href="user/assets/css/style.css" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
	<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

	<style>
		.coupon-container {
		  display: flex;
		  flex-direction: column;
		  gap: 15px;
		}
		
		.coupon-item {
		  display: flex;
		  align-items: center;
		  justify-content: space-between;
		  padding: 10px 15px;
		  background-color: #f8f9fa;
		  border-radius: 5px;
		  border: 1px solid #dee2e6;
		}
		
		.coupon-code {
		  font-size: 18px;
		  font-weight: 500;
		  letter-spacing: 1px;
		  color: #212529;
		}
		
		.copy-btn {
		  min-width: 80px;
		}
		
		.no-coupons {
		  text-align: center;
		  color: #6c757d;
		  font-style: italic;
		}
	  </style>
</head>

<body>
	<div class="page-wrapper">
		<header class="header">
			<div class="header-top">
				<div class="container">
					<div class="header-left">
					
						<!-- End .header-dropdown -->

						<div class="header-dropdown">
							
						
							<!-- End .header-menu -->
						</div>
						<!-- End .header-dropdown -->
					</div>
				</div>
				<!-- End .container -->
			</div>
			<!-- End .header-top -->

			<div class="header-middle sticky-header">
				<div class="container">
					<div class="header-left">
						<button class="mobile-menu-toggler">
							<span class="sr-only">Toggle mobile menu</span>
							<i class="icon-bars"></i>
						</button>

						<a href="/" class="logo">
							<img src="/Redolence logo-01.png" alt="Redole Logo" style="width: 315px; height: 126px" />
						</a>

						<nav class="main-nav">
							<ul class="menu sf-arrows">
								<li>
									<a href="/" class="">Home</a>
								</li>
								<li>
									<a href="/shop" class="">Product</a>
								</li>
							</ul>
							<!-- End .menu -->
						</nav>
					</div>
					<!-- End .header-left -->
					<div>
						<a href="/wallet">
							<i class="fa-solid fa-wallet"
								style="color: black; font-size: 20px; padding-left: 421px;"></i>
						</a>
					</div>

					<div class="header-right">

						<div class="dropdown cart-dropdown">
							<a href="cart" class="dropdown-toggle">
								<i class="icon-shopping-cart"></i>
							</a>
						</div>
						<!-- End .cart-dropdown -->
					</div>
					<!-- End .header-right -->
				</div>
				<!-- End .container -->
			</div>
			<!-- End .header-middle -->
		</header>
		<!-- End .header -->

		<main class="main">
			<div class="page-header text-center" style="background-image: url('user/assets/images/page-header-bg.jpg')">
				<div class="container">
					<h1 class="page-title">Checkout<span>Shop</span></h1>
				</div>
				<!-- End .container -->
			</div>
			<!-- End .page-header -->
			<nav aria-label="breadcrumb" class="breadcrumb-nav">
				<div class="container">
					<ol class="breadcrumb">
						<li class="breadcrumb-item"><a href="index.html">Home</a></li>
						<li class="breadcrumb-item"><a href="#">Shop</a></li>
						
					</ol>
				</div>
				<!-- End .container -->
			</nav>
			<!-- End .breadcrumb-nav -->

			<div class="page-content">
				<div class="checkout">
					<div class="container">
						<div class="checkout-discount"></div>
						<!-- End .checkout-discount -->
						<form id="add-new-address">
							<div class="row">
								<div class="col-lg-9">
									<h2>Checkout Form</h2>

									<div class="existing-addresses">
										<h3>Select Shipping Address</h3>
										<div id="addressList">
											<% if (existingAddresses && existingAddresses.length>
												0) { %> <% existingAddresses.forEach((addr, index)=> {
													%>
													<div class="address-item" data-index="<%= index %>">
														<input type="radio" name="selectedAddress"
															value="<%= addr._id %>" id="address<%= index %>" required />
														<label for="address<%= index %>">
															<strong>
																<%= addr.name %>
															</strong><br />
															<%= addr.streetAddress %>, <%= addr.city %><br />
																	<%= addr.state %> - <%= addr.pinCode %><br />
																			Mobile: <%= addr.mobile %>
														</label>
														<br />
														<button id="deleteAddress"
															class="btn btn-secondary btn-sm btn-block"
															style="background-color: #db4437; width: 100px">
															Delete
														</button>
														<button id="editAddress"
															class="btn btn-secondary btn-sm btn-block"
															style="width: 100px">
															Edit
														</button>

														<!-- Add this to your existing modal section -->
														<div class="modal fade" id="editAddressModal" tabindex="-1"
															role="dialog" aria-labelledby="editAddressModalLabel"
															aria-hidden="true">
															<div class="modal-dialog" role="document">
																<div class="modal-content">
																	<div class="modal-header">
																		<h5 class="modal-title"
																			id="editAddressModalLabel">
																			Edit Address
																		</h5>
																		<button type="button" class="close"
																			data-dismiss="modal" aria-label="Close">
																			<span aria-hidden="true">&times;</span>
																		</button>
																	</div>
																	<div class="modal-body">
																		<form id="editAddressForm" novalidate>
																			<input type="hidden" id="editAddressId"
																				name="addressId" />
																			<div class="row">
																				<div class="col-md-6">
																					<div class="form-group">
																						<label for="editName">Full Name
																							*</label>
																						<input type="text"
																							class="form-control"
																							id="editName" name="name"
																							required />
																						<div class="invalid-feedback"
																							id="editName-error"></div>
																					</div>
																				</div>
																				<div class="col-md-6">
																					<div class="form-group">
																						<label for="editMobile">Mobile
																							Number *</label>
																						<input type="tel"
																							class="form-control"
																							id="editMobile"
																							name="mobile" required />
																						<div class="invalid-feedback"
																							id="editMobile-error"></div>
																					</div>
																				</div>
																			</div>

																			<div class="form-group">
																				<label for="editStreetAddress">Street
																					Address *</label>
																				<input type="text" class="form-control"
																					id="editStreetAddress"
																					name="streetAddress" required />
																				<div class="invalid-feedback"
																					id="editStreetAddress-error"></div>
																			</div>

																			<div class="row">
																				<div class="col-md-6">
																					<div class="form-group">
																						<label for="editCity">City
																							*</label>
																						<input type="text"
																							class="form-control"
																							id="editCity" name="city"
																							required />
																						<div class="invalid-feedback"
																							id="editCity-error"></div>
																					</div>
																				</div>
																				<div class="col-md-6">
																					<div class="form-group">
																						<label
																							for="editLandmark">Landmark
																							*</label>
																						<input type="text"
																							class="form-control"
																							id="editLandmark"
																							name="landmark" required />
																						<div class="invalid-feedback"
																							id="editLandmark-error">
																						</div>
																					</div>
																				</div>
																			</div>

																			<div class="row">
																				<div class="col-md-6">
																					<div class="form-group">
																						<label for="editState">State
																							*</label>
																						<input type="text"
																							class="form-control"
																							id="editState" name="state"
																							required />
																						<div class="invalid-feedback"
																							id="editState-error"></div>
																					</div>
																				</div>
																				<div class="col-md-6">
																					<div class="form-group">
																						<label for="editPinCode">PIN
																							Code *</label>
																						<input type="text"
																							class="form-control"
																							id="editPinCode"
																							name="pinCode" required />
																						<div class="invalid-feedback"
																							id="editPinCode-error">
																						</div>
																					</div>
																				</div>
																			</div>
																		</form>
																	</div>
																	<div class="modal-footer">
																		<button type="button" class="btn btn-secondary"
																			data-dismiss="modal">
																			Cancel
																		</button>
																		<button type="button" class="btn btn-primary"
																			id="updateAddress">
																			Update Address
																		</button>
																	</div>
																</div>
															</div>
														</div>
													</div>
													<% }); %>
														<% } else { %>
															<p id="no-addresses">
																No saved addresses. Please add a new address.
															</p>
															<% } %>
										</div>
									</div>
									<br />

									<link
										href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
										rel="stylesheet" />
									<div class="form-group">
										<button type="button" class="btn btn-secondary btn-sm btn-block"
											id="addAddressBtn" style="width: 50px">
											<i class="fas fa-plus"></i> Add New Address
										</button>
									</div>
									<!-- Add New Address Modal -->
									<div class="modal fade" id="addAddressModal" tabindex="-1" role="dialog"
										aria-labelledby="addAddressModalLabel" aria-hidden="true">
										<div class="modal-dialog" role="document">
											<div class="modal-content">
												<div class="modal-header">
													<h5 class="modal-title" id="addAddressModalLabel">
														Add New Address
													</h5>
													<button type="submit" class="close" data-dismiss="modal"
														aria-label="Close">
														<span aria-hidden="true">&times;</span>
													</button>
												</div>
												<div class="modal-body">
													<form id="addAddressForm" novalidate>
														<label style="color: #db4437" id="informationlabel"
															for=""></label>
														<div class="row">
															<div class="col-md-6">
																<div class="form-group">
																	<label for="name">Full Name *</label>
																	<input type="text" class="form-control" id="name"
																		name="name" required />
																	<div class="invalid-feedback" id="name-error"></div>
																</div>
															</div>
															<div class="col-md-6">
																<div class="form-group">
																	<label for="mobile">Mobile Number *</label>
																	<input type="tel" class="form-control" id="mobile"
																		name="mobile" required />
																	<div class="invalid-feedback" id="mobile-error">
																	</div>
																</div>
															</div>
														</div>

														<div class="form-group">
															<label for="streetAddress">Street Address *</label>
															<input type="text" class="form-control" id="streetAddress"
																name="streetAddress" required />
															<div class="invalid-feedback" id="streetAddress-error">
															</div>
														</div>

														<div class="row">
															<div class="col-md-6">
																<div class="form-group">
																	<label for="city">City *</label>
																	<input type="text" class="form-control" id="city"
																		name="city" required />
																	<div class="invalid-feedback" id="city-error"></div>
																</div>
															</div>
															<div class="col-md-6">
																<div class="form-group">
																	<label for="landmark">Landmark *</label>
																	<input type="text" class="form-control"
																		id="landmark" name="landmark" required />
																	<div class="invalid-feedback" id="landmark-error">
																	</div>
																</div>
															</div>
														</div>

														<div class="row">
															<div class="col-md-6">
																<div class="form-group">
																	<label for="state">State *</label>
																	<input type="text" class="form-control" id="state"
																		name="state" required />
																	<div class="invalid-feedback" id="state-error">
																	</div>
																</div>
															</div>
															<div class="col-md-6">
																<div class="form-group">
																	<label for="pinCode">PIN Code *</label>
																	<input type="text" class="form-control" id="pinCode"
																		name="pinCode" required />
																	<div class="invalid-feedback" id="pinCode-error">
																	</div>
																</div>
															</div>
														</div>
													</form>
												</div>
												<div class="modal-footer">
													<button type="button" class="btn btn-secondary"
														data-dismiss="modal">
														Cancel
													</button>
													<button type="button" class="btn btn-primary" id="saveAddress">
														Save Address
													</button>
												</div>
											</div>
										</div>
									</div>

									<!-- Add more fields as necessary -->
								</div>
								<!-- End .col-lg-9 -->

								<aside class="col-lg-3">
									<!-- Move the summary to the right -->
									<!-- Update the order summary section in checkout.ejs -->
									<div class="summary" style="width: 800px; margin-left: -280px">
										<h3 class="summary-title">Your Order</h3>

										<table class="table table-summary">
											<thead>
												<tr>
													<th>Product</th>

													<th>Quantity</th>
													<th>Total</th>
												</tr>
											</thead>
											<tbody>
												<% let subtotal=0; %>
													<% cart.productDetails.forEach(item=> { %> <% if (item.productId) {
															%>
															<% const itemTotal=item.productId.price * item.quantity; %>
																<% subtotal +=itemTotal; %>
																	<tr>
																		<td>
																			<h4 class="product-title">
																				<%= item.productId.name %>
																			</h4>
																			<span class="product-price">₹<%=
																					item.productId.price %></span>
																		</td>
																		<td>
																			<%= item.quantity %>
																		</td>
																		<td>₹<%= itemTotal %>
																		</td>
																	</tr>
																	<% } %>
																		<% }); %>

																			<tr>
																				<td>Subtotal:</td>
																				<td colspan="3" class="text-right">
																					₹<%= subtotal %>
																				</td>
																			</tr>
																			<tr>
																				<td>Shipping:</td>
																				<td colspan="3" class="text-right">
																					Free shipping
																				</td>
																			</tr>
																			<tr>
																				<td>Coupon:</td>
																				<td colspan="3" class="text-right"
																					id="couponDiscount">0</td>
																			</tr>

																			<tr class="summary-total">
																				<td>Total:</td>
																				<td colspan="3" class="text-right">
																					<span
																						class="currency-symbol">₹</span>
																					<span class="subtotal-value"
																						id="totalAmount">
																						<%= subtotal %>
																					</span>
																				</td>
																			</tr>
											</tbody>
										</table>

										<div class="accordion-summary" id="accordion-payment">
											<div class="card">
												<div class="card-header" id="heading-1">
													<h2 class="card-title">

														<h6>Select your Delivery Option</h6>
														<input type="radio" name="paymentMethod" id="cod" value="COD"
															required />
														<label for="cod">Cash On Delivery</label>
														<br>
														<input type="radio" name="paymentMethod" id="online"
															value="Online" required />
														<label for="online">Razorpay</label>
														<br>
														<input type="radio" name="paymentMethod" id="wallet"
															value="<%= wallet[0].balance %>" required />
														<label for="wallet">wallet balance <%= wallet[0].balance %></label>
													</h2>
												</div>
											</div>
										</div>

										<button id="placeOrderBtn"
											class="btn btn-outline-primary-2 btn-order btn-block">
											<span class="btn-text">Place Order</span>
											<span class="btn-hover-text">Place Order</span>
										</button>
									</div>

									<form id="couponForm">
										<input type="text" id="couponCode" name="couponCode"
											placeholder="Enter Coupon Code" required>
										<button type="submit">Apply Coupon</button>
									</form>

									<!-- Show Coupons Button -->
									<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
										Show Coupons
									  </button>

									  <!-- Bootstrap Modal -->
									<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true"> 
										<div class="modal-dialog modal-dialog-centered" role="document"> 
										<div class="modal-content"> 
											<div class="modal-header">
											<h5 class="modal-title" id="exampleModalLabel">Coupons</h5> 
											<button type="button" class="close" data-dismiss="modal" aria-label="Close"> 
												<span aria-hidden="true">&times;</span> 
											</button> 
											</div> 
											<div class="modal-body"> 
											<% if (coupons && coupons.length > 0) { %> 
												<div class="coupon-container">
												<% coupons.forEach(coupon => { %> 
													<div class="coupon-item">
													<div class="coupon-code"><%= coupon.code %></div>
													<button class="btn btn-primary copy-btn" data-code="<%= coupon.code %>">Copy</button> 
													</div> 
												<% }); %> 
												</div>
											<% } else { %> 
												<p class="no-coupons">No active coupons available.</p> 
											<% } %> 
											</div>
											<div class="modal-footer">
											<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
											</div>
										</div> 
										</div> 
									</div> 
									
									
								</aside>
								<!-- End .col-lg-3 -->
							</div>
							<!-- End .row -->
						</form>
					</div>
					<!-- End .container -->
				</div>
				<!-- End .checkout -->
			</div>
			<!-- End .page-content -->
		</main>
		<!-- End .main -->
		
		
		<footer class="footer">
			<div class="footer-middle">
				<div class="container">
					<div class="row">
						<div class="col-sm-6 col-lg-3">
							<div class="widget widget-about">
								<img src="/Redolence logo-01.png" class="footer-logo" alt="Footer Logo" width="105"
									height="25" />
								<p>
									Praesent dapibus, neque id cursus ucibus, tortor neque
									egestas augue, eu vulputate magna eros eu erat.
								</p>

								<div class="social-icons">
									<a href="#" class="social-icon" target="_blank" title="Facebook"><i
											class="icon-facebook-f"></i></a>
									<a href="#" class="social-icon" target="_blank" title="Twitter"><i
											class="icon-twitter"></i></a>
									<a href="#" class="social-icon" target="_blank" title="Instagram"><i
											class="icon-instagram"></i></a>
									<a href="#" class="social-icon" target="_blank" title="Youtube"><i
											class="icon-youtube"></i></a>
									<a href="#" class="social-icon" target="_blank" title="Pinterest"><i
											class="icon-pinterest"></i></a>
								</div>
								<!-- End .soial-icons -->
							</div>
							<!-- End .widget about-widget -->
						</div>
						<!-- End .col-sm-6 col-lg-3 -->

						<div class="col-sm-6 col-lg-3">
							<div class="widget">
								<h4 class="widget-title">Useful Links</h4>
								<!-- End .widget-title -->

								<ul class="widget-list">
									<li><a href="about.html">About Redolence</a></li>
									<li><a href="#">How to shop on Redolence</a></li>
									<li><a href="#">FAQ</a></li>
									<li><a href="contact.html">Contact us</a></li>
									<li><a href="login.html">Log in</a></li>
								</ul>
								<!-- End .widget-list -->
							</div>
							<!-- End .widget -->
						</div>
						<!-- End .col-sm-6 col-lg-3 -->

						<div class="col-sm-6 col-lg-3">
							<div class="widget">
								<h4 class="widget-title">Customer Service</h4>
								<!-- End .widget-title -->

								<ul class="widget-list">
									<li><a href="#">Payment Methods</a></li>
									<li><a href="#">Money-back guarantee!</a></li>
									<li><a href="#">Returns</a></li>
									<li><a href="#">Shipping</a></li>
									<li><a href="#">Terms and conditions</a></li>
									<li><a href="#">Privacy Policy</a></li>
								</ul>
								<!-- End .widget-list -->
							</div>
							<!-- End .widget -->
						</div>
						<!-- End .col-sm-6 col-lg-3 -->

						<div class="col-sm-6 col-lg-3">
							<div class="widget">
								<h4 class="widget-title">My Account</h4>
								<!-- End .widget-title -->

								<ul class="widget-list">
									<li><a href="#">Sign In</a></li>
									<li><a href="cart.html">View Cart</a></li>
									<li><a href="#">My Wishlist</a></li>
									<li><a href="#">Track My Order</a></li>
									<li><a href="#">Help</a></li>
								</ul>
								<!-- End .widget-list -->
							</div>
							<!-- End .widget -->
						</div>
						<!-- End .col-sm-6 col-lg-3 -->
					</div>
					<!-- End .row -->
				</div>
				<!-- End .container -->
			</div>
			<!-- End .footer-middle -->

			<div class="footer-bottom">
				<div class="container">
					<p class="footer-copyright">
						Copyright © 2019 Redolence Store. All Rights Reserved.
					</p>
					<!-- End .footer-copyright -->
					<figure class="footer-payments">
						<img src="user/assets/images/payments.png" alt="Payment methods" width="272" height="20" />
					</figure>
					<!-- End .footer-payments -->
				</div>
				<!-- End .container -->
			</div>
			<!-- End .footer-bottom -->
		</footer>
		<!-- End .footer -->
	</div>
	<!-- End .page-wrapper -->
	<button id="scroll-top" title="Back to Top">
		<i class="icon-arrow-up"></i>
	</button>

	<!-- Mobile Menu -->
	<div class="mobile-menu-overlay"></div>
	<!-- End .mobil-menu-overlay -->

	<div class="mobile-menu-container">
		<div class="mobile-menu-wrapper">
			<span class="mobile-menu-close"><i class="icon-close"></i></span>

			<form action="#" method="get" class="mobile-search">
				<label for="mobile-search" class="sr-only">Search</label>
				<input type="search" class="form-control" name="mobile-search" id="mobile-search"
					placeholder="Search in..." required />
				<button class="btn btn-primary" type="submit">
					<i class="icon-search"></i>
				</button>
			</form>

			<nav class="mobile-nav">
				<ul class="mobile-menu">
					<li class="active">
						<a href="/">Home</a>

						<ul>
							<li><a href="index-1.html">01 - furniture store</a></li>
							<li><a href="index-2.html">02 - furniture store</a></li>
							<li><a href="index-3.html">03 - electronic store</a></li>
							<li><a href="index-4.html">04 - electronic store</a></li>
							<li><a href="index-5.html">05 - fashion store</a></li>
							<li><a href="index-6.html">06 - fashion store</a></li>
							<li><a href="index-7.html">07 - fashion store</a></li>
							<li><a href="index-8.html">08 - fashion store</a></li>
							<li><a href="index-9.html">09 - fashion store</a></li>
							<li><a href="index-10.html">10 - shoes store</a></li>
							<li><a href="index-11.html">11 - furniture simple store</a></li>
							<li><a href="index-12.html">12 - fashion simple store</a></li>
							<li><a href="index-13.html">13 - market</a></li>
							<li><a href="index-14.html">14 - market fullwidth</a></li>
							<li><a href="index-15.html">15 - lookbook 1</a></li>
							<li><a href="index-16.html">16 - lookbook 2</a></li>
							<li><a href="index-17.html">17 - fashion store</a></li>
							<li>
								<a href="index-18.html">18 - fashion store (with sidebar)</a>
							</li>
							<li><a href="index-19.html">19 - games store</a></li>
							<li><a href="index-20.html">20 - book store</a></li>
							<li><a href="index-21.html">21 - sport store</a></li>
							<li><a href="index-22.html">22 - tools store</a></li>
							<li>
								<a href="index-23.html">23 - fashion left navigation store</a>
							</li>
							<li><a href="index-24.html">24 - extreme sport store</a></li>
						</ul>
					</li>
					<li>
						<a href="category.html">Shop</a>
						<ul>
							<li><a href="category-list.html">Shop List</a></li>
							<li><a href="category-2cols.html">Shop Grid 2 Columns</a></li>
							<li><a href="category.html">Shop Grid 3 Columns</a></li>
							<li><a href="category-4cols.html">Shop Grid 4 Columns</a></li>
							<li>
								<a href="category-boxed.html"><span>Shop Boxed No Sidebar<span
											class="tip tip-hot">Hot</span></span></a>
							</li>
							<li>
								<a href="category-fullwidth.html">Shop Fullwidth No Sidebar</a>
							</li>
							<li>
								<a href="product-category-boxed.html">Product Category Boxed</a>
							</li>
							<li>
								<a href="product-category-fullwidth.html"><span>Product Category Fullwidth<span
											class="tip tip-new">New</span></span></a>
							</li>
							<li><a href="cart.html">Cart</a></li>
							<li><a href="checkout.html">Checkout</a></li>
							<li><a href="wishlist.html">Wishlist</a></li>
							<li><a href="#">Lookbook</a></li>
						</ul>
					</li>
					<li>
						<a href="product.html" class="sf-with-ul">Product</a>
						<ul>
							<li><a href="product.html">Default</a></li>
							<li><a href="product-centered.html">Centered</a></li>
							<li>
								<a href="product-extended.html"><span>Extended Info<span
											class="tip tip-new">New</span></span></a>
							</li>
							<li><a href="product-gallery.html">Gallery</a></li>
							<li><a href="product-sticky.html">Sticky Info</a></li>
							<li><a href="product-sidebar.html">Boxed With Sidebar</a></li>
							<li><a href="product-fullwidth.html">Full Width</a></li>
							<li><a href="product-masonry.html">Masonry Sticky Info</a></li>
						</ul>
					</li>
					<li>
						<a href="#">Pages</a>
						<ul>
							<li>
								<a href="about.html">About</a>

								<ul>
									<li><a href="about.html">About 01</a></li>
									<li><a href="about-2.html">About 02</a></li>
								</ul>
							</li>
							<li>
								<a href="contact.html">Contact</a>

								<ul>
									<li><a href="contact.html">Contact 01</a></li>
									<li><a href="contact-2.html">Contact 02</a></li>
								</ul>
							</li>
							<li><a href="login.html">Login</a></li>
							<li><a href="faq.html">FAQs</a></li>
							<li><a href="404.html">Error 404</a></li>
							<li><a href="coming-soon.html">Coming Soon</a></li>
						</ul>
					</li>
					<li>
						<a href="blog.html">Blog</a>

						<ul>
							<li><a href="blog.html">Classic</a></li>
							<li><a href="blog-listing.html">Listing</a></li>
							<li>
								<a href="#">Grid</a>
								<ul>
									<li><a href="blog-grid-2cols.html">Grid 2 columns</a></li>
									<li><a href="blog-grid-3cols.html">Grid 3 columns</a></li>
									<li><a href="blog-grid-4cols.html">Grid 4 columns</a></li>
									<li><a href="blog-grid-sidebar.html">Grid sidebar</a></li>
								</ul>
							</li>
							<li>
								<a href="#">Masonry</a>
								<ul>
									<li>
										<a href="blog-masonry-2cols.html">Masonry 2 columns</a>
									</li>
									<li>
										<a href="blog-masonry-3cols.html">Masonry 3 columns</a>
									</li>
									<li>
										<a href="blog-masonry-4cols.html">Masonry 4 columns</a>
									</li>
									<li>
										<a href="blog-masonry-sidebar.html">Masonry sidebar</a>
									</li>
								</ul>
							</li>
							<li>
								<a href="#">Mask</a>
								<ul>
									<li><a href="blog-mask-grid.html">Blog mask grid</a></li>
									<li>
										<a href="blog-mask-masonry.html">Blog mask masonry</a>
									</li>
								</ul>
							</li>
							<li>
								<a href="#">Single Post</a>
								<ul>
									<li><a href="single.html">Default with sidebar</a></li>
									<li>
										<a href="single-fullwidth.html">Fullwidth no sidebar</a>
									</li>
									<li>
										<a href="single-fullwidth-sidebar.html">Fullwidth with sidebar</a>
									</li>
								</ul>
							</li>
						</ul>
					</li>
					<li>
						<a href="elements-list.html">Elements</a>
						<ul>
							<li><a href="elements-products.html">Products</a></li>
							<li><a href="elements-typography.html">Typography</a></li>
							<li><a href="elements-titles.html">Titles</a></li>
							<li><a href="elements-banners.html">Banners</a></li>
							<li>
								<a href="elements-product-category.html">Product Category</a>
							</li>
							<li><a href="elements-video-banners.html">Video Banners</a></li>
							<li><a href="elements-buttons.html">Buttons</a></li>
							<li><a href="elements-accordions.html">Accordions</a></li>
							<li><a href="elements-tabs.html">Tabs</a></li>
							<li><a href="elements-testimonials.html">Testimonials</a></li>
							<li><a href="elements-blog-posts.html">Blog Posts</a></li>
							<li><a href="elements-portfolio.html">Portfolio</a></li>
							<li><a href="elements-cta.html">Call to Action</a></li>
							<li><a href="elements-icon-boxes.html">Icon Boxes</a></li>
						</ul>
					</li>
				</ul>
			</nav>
			<!-- End .mobile-nav -->

			<div class="social-icons">
				<a href="#" class="social-icon" target="_blank" title="Facebook"><i class="icon-facebook-f"></i></a>
				<a href="#" class="social-icon" target="_blank" title="Twitter"><i class="icon-twitter"></i></a>
				<a href="#" class="social-icon" target="_blank" title="Instagram"><i class="icon-instagram"></i></a>
				<a href="#" class="social-icon" target="_blank" title="Youtube"><i class="icon-youtube"></i></a>
			</div>
			<!-- End .social-icons -->
		</div>
		<!-- End .mobile-menu-wrapper -->
	</div>
	<!-- End .mobile-menu-container -->

	<!-- Sign in / Register Modal -->
	<div class="modal fade" id="signin-modal" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document">
			<div class="modal-content">
				<div class="modal-body">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true"><i class="icon-close"></i></span>
					</button>

					<div class="form-box">
						<div class="form-tab">
							<ul class="nav nav-pills nav-fill" role="tablist">
								<li class="nav-item">
									<a class="nav-link active" id="signin-tab" data-toggle="tab" href="#signin"
										role="tab" aria-controls="signin" aria-selected="true">Sign In</a>
								</li>
								<li class="nav-item">
									<a class="nav-link" id="register-tab" data-toggle="tab" href="#register" role="tab"
										aria-controls="register" aria-selected="false">Register</a>
								</li>
							</ul>
							<div class="tab-content" id="tab-content-5">
								<div class="tab-pane fade show active" id="signin" role="tabpanel"
									aria-labelledby="signin-tab">
									<form action="#">
										<div class="form-group">
											<label for="singin-email">Username or email address *</label>
											<input type="text" class="form-control" id="singin-email"
												name="singin-email" required />
										</div>
										<!-- End .form-group -->

										<div class="form-group">
											<label for="singin-password">Password *</label>
											<input type="password" class="form-control" id="singin-password"
												name="singin-password" required />
										</div>
										<!-- End .form-group -->

										<div class="form-footer">
											<button type="submit" class="btn btn-outline-primary-2">
												<span>LOG IN</span>
												<i class="icon-long-arrow-right"></i>
											</button>

											<div class="custom-control custom-checkbox">
												<input type="checkbox" class="custom-control-input"
													id="signin-remember" />
												<label class="custom-control-label" for="signin-remember">Remember
													Me</label>
											</div>
											<!-- End .custom-checkbox -->

											<a href="#" class="forgot-link">Forgot Your Password?</a>
										</div>
										<!-- End .form-footer -->
									</form>
									<div class="form-choice">
										<p class="text-center">or sign in with</p>
										<div class="row">
											<div class="col-sm-6">
												<a href="#" class="btn btn-login btn-g">
													<i class="icon-google"></i>
													Login With Google
												</a>
											</div>
											<!-- End .col-6 -->
											<div class="col-sm-6">
												<a href="#" class="btn btn-login btn-f">
													<i class="icon-facebook-f"></i>
													Login With Facebook
												</a>
											</div>
											<!-- End .col-6 -->
										</div>
										<!-- End .row -->
									</div>
									<!-- End .form-choice -->
								</div>
								<!-- .End .tab-pane -->
								<div class="tab-pane fade" id="register" role="tabpanel" aria-labelledby="register-tab">
									<form action="#">
										<div class="form-group">
											<label for="register-email">Your email address *</label>
											<input type="email" class="form-control" id="register-email"
												name="register-email" required />
										</div>
										<!-- End .form-group -->

										<div class="form-group">
											<label for="register-password">Password *</label>
											<input type="password" class="form-control" id="register-password"
												name="register-password" required />
										</div>
										<!-- End .form-group -->

										<div class="form-footer">
											<button type="submit" class="btn btn-outline-primary-2">
												<span>SIGN UP</span>
												<i class="icon-long-arrow-right"></i>
											</button>

											<div class="custom-control custom-checkbox">
												<input type="checkbox" class="custom-control-input" id="register-policy"
													required />
												<label class="custom-control-label" for="register-policy">I agree to the
													<a href="#">privacy policy</a> *</label>
											</div>
											<!-- End .custom-checkbox -->
										</div>
										<!-- End .form-footer -->
									</form>
									<div class="form-choice">
										<p class="text-center">or sign in with</p>
										<div class="row">
											<div class="col-sm-6">
												<a href="#" class="btn btn-login btn-g">
													<i class="icon-google"></i>
													Login With Google
												</a>
											</div>
											<!-- End .col-6 -->
											<div class="col-sm-6">
												<a href="#" class="btn btn-login btn-f">
													<i class="icon-facebook-f"></i>
													Login With Facebook
												</a>
											</div>
											<!-- End .col-6 -->
										</div>
										<!-- End .row -->
									</div>
									<!-- End .form-choice -->
								</div>
								<!-- .End .tab-pane -->
							</div>
							<!-- End .tab-content -->
						</div>
						<!-- End .form-tab -->
					</div>
					<!-- End .form-box -->
				</div>
				<!-- End .modal-body -->
			</div>
			<!-- End .modal-content -->
		</div>
		<!-- End .modal-dialog -->
	</div>
	<!-- End .modal -->

	<!-- Plugins JS File -->
	<script src="user/assets/js/jquery.min.js"></script>
	<script src="user/assets/js/bootstrap.bundle.min.js"></script>
	<script src="user/assets/js/jquery.hoverIntent.min.js"></script>
	<script src="user/assets/js/jquery.waypoints.min.js"></script>
	<script src="user/assets/js/superfish.min.js"></script>
	<script src="user/assets/js/owl.carousel.min.js"></script>
	<!-- Main JS File -->
	<script src="user/assets/js/main.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	<script src="https://checkout.razorpay.com/v1/checkout.js"></script>



	<!-- Modal for Address Selection -->
	<div class="modal fade" id="addressModal" tabindex="-1" role="dialog" aria-labelledby="addressModalLabel"
		aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="addressModalLabel">
						No Address Selected
					</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<p>
						Please select a shipping address to proceed with your order. You
						can also add a new address.
					</p>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-dismiss="modal">
						Close
					</button>
					<button type="button" class="btn btn-primary" id="addAddressBtn" data-dismiss="modal">
						Add Address
					</button>
				</div>
			</div>
		</div>
	</div>




	<script>
		document.addEventListener('DOMContentLoaded', () => {
			// Edit Address Functionality
			const editButtons = document.querySelectorAll('#editAddress');

			editButtons.forEach((button) => {
				button.addEventListener('click', async (e) => {
					e.preventDefault();

					const addressItem = e.target.closest('.address-item');
					const addressId = addressItem.querySelector(
						'input[name="selectedAddress"]'
					).value;

					try {
						// Fetch address details
						const response = await fetch(`/get-address/${addressId}`);
						const result = await response.json();

						if (result.success) {
							// Create or update edit modal
							createEditAddressModal(result.address, addressId);
						} else {
							Swal.fire({
								icon: 'error',
								title: 'Fetch Failed',
								text: result.message,
							});
						}
					} catch (error) {
						console.error('Edit Address Error:', error);
						Swal.fire({
							icon: 'error',
							title: 'Error',
							text: 'Something went wrong. Please try again.',
						});
					}
				});
			});

			// Function to create edit address modal
			function createEditAddressModal(address, addressId) {
				// Remove existing modal if any
				const existingModal = document.getElementById('editAddressModal');
				if (existingModal) {
					existingModal.remove();
				}

				// Create modal HTML
				const modalHtml = `
            <div class="modal fade" id="editAddressModal" tabindex="-1" role="dialog">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Edit Address</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <form id="editAddressForm">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="edit-name">Full Name *</label>
                                            <input type="text" class="form-control" id="edit-name" value="${address.name}" required>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="edit-mobile">Mobile Number *</label>
                                            <input type="tel" class="form-control" id="edit-mobile" value="${address.mobile}" required>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="edit-streetAddress">Street Address *</label>
                                    <input type="text" class="form-control" id="edit-streetAddress" value="${address.streetAddress}" required>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="edit-city">City *</label>
                                            <input type="text" class="form-control" id="edit-city" value="${address.city}" required>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="edit-landmark">Landmark *</label>
                                            <input type="text" class="form-control" id="edit-landmark" value="${address.landmark}" required>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="edit-state">State *</label>
                                            <input type="text" class="form-control" id="edit-state" value="${address.state}" required>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="edit-pinCode">PIN Code *</label>
                                            <input type="text" class="form-control" id="edit-pinCode" value="${address.pinCode}" required>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-primary" id="saveEditedAddress" data-address-id="${addressId}">Save Changes</button>
                        </div>
                    </div>
                </div>
            </div>
        `;

				// Append modal to body
				document.body.insertAdjacentHTML('beforeend', modalHtml);

				// Show the modal
				$('#editAddressModal').modal('show');

				// Add event listener for save button
				document
					.getElementById('saveEditedAddress')
					.addEventListener('click', async () => {
						const addressId =
							document.getElementById('saveEditedAddress').dataset.addressId;

						// Collect form data
						const formData = {
							name: document.getElementById('edit-name').value,
							mobile: document.getElementById('edit-mobile').value,
							streetAddress:
								document.getElementById('edit-streetAddress').value,
							city: document.getElementById('edit-city').value,
							landmark: document.getElementById('edit-landmark').value,
							state: document.getElementById('edit-state').value,
							pinCode: document.getElementById('edit-pinCode').value,
						};

						try {
							// Send update request
							const response = await fetch(`/update-address/${addressId}`, {
								method: 'PUT',
								headers: {
									'Content-Type': 'application/json',
								},
								body: JSON.stringify(formData),
							});

							const result = await response.json();

							if (result.success) {
								// Close modal
								$('#editAddressModal').modal('hide');

								// Show success message
								Swal.fire({
									icon: 'success',
									title: 'Address Updated',
									text: result.message,
								});

								// Optionally update the address in the DOM
								updateAddressInDOM(addressId, result.updatedAddress);
							} else {
								// Show error message
								Swal.fire({
									icon: 'error',
									title: 'Update Failed',
									text: result.message || 'Failed to update address',
								});
							}
						} catch (error) {
							console.error('Update Address Error:', error);
							Swal.fire({
								icon: 'error',
								title: 'Error',
								text: 'Something went wrong. Please try again.',
							});
						}
					});
			}

			// Function to update address in DOM
			function updateAddressInDOM(addressId, updatedAddress) {
				const addressItem = document
					.querySelector(`.address-item input[value="${addressId}"]`)
					.closest('.address-item');

				if (addressItem) {
					const addressLabel = addressItem.querySelector('label');
					addressLabel.innerHTML = `
                <strong>${updatedAddress.name}</strong><br>
                ${updatedAddress.streetAddress}, ${updatedAddress.city}<br>
                ${updatedAddress.state} - ${updatedAddress.pinCode}<br>
                Mobile: ${updatedAddress.mobile}
            `;
				}
			}
		});
	</script>

	<!-- show coupon modal script -->
	<script> 
		document.addEventListener('DOMContentLoaded', function() {
		  // Find all copy buttons
		  const copyButtons = document.querySelectorAll('.copy-btn');
		  
		  // Add click event to each button
		  copyButtons.forEach(button => {
			button.addEventListener('click', function() {
			  const code = this.getAttribute('data-code');
			  
			  // Copy to clipboard
			  navigator.clipboard.writeText(code)
				.then(() => {
				  // Change button text temporarily
				  const originalText = this.textContent;
				  this.textContent = "Copied!";
				  this.classList.add('btn-success');
				  this.classList.remove('btn-primary');
				  
				  // Reset button after 2 seconds
				  setTimeout(() => {
					this.textContent = originalText;
					this.classList.add('btn-primary');
					this.classList.remove('btn-success');
				  }, 2000);
				})
				.catch(err => {
				  console.error("Failed to copy: ", err);
				  alert("Failed to copy. Please try again.");
				});
			});
		  });
		  
		  // Close modal event handling
		  const closeButtons = document.querySelectorAll('[data-dismiss="modal"]');
		  closeButtons.forEach(button => {
			button.addEventListener('click', function() {
			  const modal = document.getElementById('exampleModal');
			  const modalInstance = bootstrap.Modal.getInstance(modal);
			  if (modalInstance) {
				modalInstance.hide();
			  } else {
				// Fallback for older Bootstrap versions
				$(modal).modal('hide');
			  }
			});
		  });
		});
	  </script>

	<!-- modal script -->
	<script>
		document
			.getElementById('addAddressBtn')
			.addEventListener('click', function () {
				// Show the modal
				$('#addAddressModal').modal('show');

				// Clear previous error messages
				const errorFields = document.querySelectorAll('.invalid-feedback');
				errorFields.forEach((field) => (field.textContent = ''));

				// Add event listener to the Save Address button
				document
					.getElementById('saveAddress')
					.addEventListener('click', function () {
						// Collect form data
						const formData = {
							name: document.getElementById('name').value,
							mobileNumber: document.getElementById('mobile').value,
							streetAddress: document.getElementById('streetAddress').value,
							city: document.getElementById('city').value,
							landmark: document.getElementById('landmark').value,
							state: document.getElementById('state').value,
							pinCode: document.getElementById('pinCode').value,
						};

						fetch('/save-address', {
							method: 'POST',
							headers: {
								'Content-Type': 'application/json',
							},
							body: JSON.stringify(formData),
						})
							.then((response) => response.json()) // Parse server response as JSON
							.then((result) => {
								if (result.success === true) {
									$('#addAddressModal').modal('hide');
									Swal.fire({
										icon: 'success',
										title: 'Success!',
										text: 'Address saved successfully!',
									});
								} else {
									// Display error message
									document.getElementById('informationlabel').textContent =
										result.message;
								}
							})
							.catch((error) => {
								console.error('Error:', error);
								Swal.fire({
									icon: 'error',
									title: 'Error!',
									text: 'An unexpected error occurred. Please try again later.',
								});
							});
					});
			});
	</script>

	<script>
		document.addEventListener('DOMContentLoaded', function () {
			document.addEventListener('click', function (event) {
				if (event.target.id === 'editAddress') {
					const addressItem = event.target.closest('.address-item');
					const addressId = addressItem.querySelector(
						'input[name="selectedAddress"]'
					).value;

					fetch(`/user/get-address/${addressId}`)
						.then((response) => response.json())
						.then((data) => {
							if (data.success) {
								const addr = data.address;

								// Populate edit modal fields
								document.getElementById('editAddressId').value = addressId;
								document.getElementById('editName').value = addr.name;
								document.getElementById('editMobile').value = addr.mobile;
								document.getElementById('editStreetAddress').value =
									addr.streetAddress;
								document.getElementById('editCity').value = addr.city;
								document.getElementById('editLandmark').value = addr.landmark;
								document.getElementById('editState').value = addr.state;
								document.getElementById('editPinCode').value = addr.pinCode;

								// Show the edit modal
								$('#editAddressModal').modal('show');
							} else {
								console.error('Error fetching address:', data);
								Swal.fire({
									icon: 'error',
									title: 'Oops...',
									text: 'Failed to fetch address details',
									confirmButtonText: 'Try Again',
								});
							}
						})
						.catch((error) => {
							console.error('Error fetching address:', error);
							Swal.fire({
								icon: 'error',
								title: 'Oops...',
								text: 'Failed to fetch address details',
								confirmButtonText: 'Try Again',
							});
						});
				}
			});

			// Update Address Button Click Handler
			document
				.getElementById('updateAddress')
				.addEventListener('click', function () {
					const addressId = document.getElementById('editAddressId').value;

					const formData = {
						name: document.getElementById('editName').value,
						mobile: document.getElementById('editMobile').value,
						streetAddress: document.getElementById('editStreetAddress').value,
						city: document.getElementById('editCity').value,
						landmark: document.getElementById('editLandmark').value,
						state: document.getElementById('editState').value,
						pinCode: document.getElementById('editPinCode').value,
					};

					const errors = [];
					for (let key in formData) {
						if (!formData[key]) {
							errors.push(`${key} is required`);
						}
					}

					if (errors.length > 0) {
						alert(errors.join('\n'));
						return;
					}

					fetch(`/user/update-address/${addressId}`, {
						method: 'PUT',
						headers: {
							'Content-Type': 'application/json',
						},
						body: JSON.stringify(formData),
					})
						.then((response) => response.json())
						.then((data) => {
							if (data.success) {
								Swal.fire({
									icon: 'success',
									title: 'Success!',
									text: 'Address updated successfully',
									confirmButtonText: 'OK',
								});
								location.reload();
							}
						})
						.catch((error) => {
							console.error('Error updating address:', error);
							Swal.fire({
								icon: 'error',
								title: 'Oops...',
								text: 'Failed to update address!',
								confirmButtonText: 'Try Again',
							});
						});
				});
		});
	</script>



	<script>
		document.addEventListener('DOMContentLoaded', () => {
			// Add event listeners to all delete buttons
			const deleteButtons =
				document.querySelectorAll('#deleteAddress');

			deleteButtons.forEach((button) => {
				button.addEventListener('click', async (e) => {
					e.preventDefault();

					const addressItem =
						e.target.closest('.address-item');
					const addressId = addressItem.querySelector(
						'input[name="selectedAddress"]'
					).value;

					try {
						const response = await fetch(
							`/delete-address/${addressId}`,
							{
								method: 'DELETE',
							}
						);

						const result = await response.json();

						if (result.success) {
							// Remove the address from the DOM
							addressItem.remove();

							Swal.fire({
								icon: 'success',
								title: 'Address Deleted',
								text: result.message,
							});

							// If no addresses left, show no addresses message
							const addressList =
								document.getElementById('addressList');
							if (addressList.children.length === 0) {
								const noAddressesMessage =
									document.createElement('p');
								noAddressesMessage.id = 'no-addresses';
								noAddressesMessage.textContent =
									'No saved addresses. Please add a new address.';
								addressList.appendChild(noAddressesMessage);
							}
						} else {
							Swal.fire({
								icon: 'error',
								title: 'Delete Failed',
								text: result.message,
							});
						}
					} catch (error) {
						console.error('Delete Address Error:', error);
						Swal.fire({
							icon: 'error',
							title: 'Error',
							text: 'Something went wrong. Please try again.',
						});
					}
				});
			});
		});
	</script>
	<script>
		document.getElementById('couponForm')
			.addEventListener('submit', async function (e) {
				e.preventDefault()
				const couponCode = document.getElementById('couponCode').value

				try {
					const response = await fetch('/applyCoupon', {
						method: 'POST',
						headers: {
							"Content-Type": "application/json"
						},
						body: JSON.stringify({ couponCode })
					})

					const result = await response.json()
					if (result.success === true) {
						document.getElementById('couponDiscount').innerHTML = `${result.discount}`;
						const total = document.getElementById('totalAmount').innerHTML
						console.log(total);

						const subtotal = total - result.discount
						document.getElementById('totalAmount').innerHTML = subtotal
						swal.fire({
							icon: 'success',
							title: 'Coupon Applied Successfully!',
							text: result.message
						})
					} else {
						swal.fire({
							icon: 'error',
							title: 'Failed to apply the coupon!',
							text: result.message
						})
					}
				} catch (error) {
					console.error('Update Address Error:', error);
					Swal.fire({
						icon: 'error',
						title: 'Error',
						text: 'Something went wrong. Please try again.',
					});
				}
			})

	</script>

	
	 <!-- 1 -->
		<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
	 <!-- 2 -->

	<script>
		document.addEventListener('DOMContentLoaded', () => {
			const placeOrderBtn = document.getElementById('placeOrderBtn');

			placeOrderBtn.addEventListener('click', async (e) => {
				e.preventDefault();

				// Check if an address is selected
				const selectedAddress = document.querySelector(
					'input[name="selectedAddress"]:checked'
				);
				if (!selectedAddress) {
					Swal.fire({
						icon: 'warning',
						title: 'Oops...',
						text: 'Please select a shipping address!',
					});
					return;
				}

				const cod = document.getElementById('cod');
				const online = document.getElementById('online');
				const walletBalance = document.getElementById('wallet').value; 
				console.log(walletBalance);
				// Get wallet balance


				// Check if a payment option is selected
				if (!cod?.checked && !online?.checked && !wallet?.checked) {
					Swal.fire({
						icon: 'warning',
						title: 'Oops.....',
						text: 'Please select a Payment Option!',
					});
					return;
				}

				const addressId = selectedAddress.value;

				let paymentMethod;

				if (wallet.checked) {
					paymentMethod = 'Wallet';
				} else if (cod.checked) {
					paymentMethod = 'COD';
				} else {
					paymentMethod = 'Online';
				}


				const couponCode = document.getElementById('couponDiscount').innerHTML

				const total = document.getElementById('totalAmount').innerHTML


				try {
					const response = await fetch('/place-order', {
						method: 'POST',
						headers: {
							'Content-Type': 'application/json',
						},
						body: JSON.stringify({
							addressId,
							paymentMethod,
							couponCode,
							total,
							wallet
						}),
					});

					const responseData = await response.json();

					// Handle non-success responses
					if (!response.ok) {
						throw new Error(responseData.error || 'Failed to place order');
					}

					// Existing payment method handling
					console.log('response', responseData)
					if (responseData.paymentMethod === 'Online') {
						// 2
						var options = {
							"key": responseData.keyId,
							"amount": responseData.amount * 100,  // Convert to paise
							"currency": "INR",
							"name": responseData.name,  // Removed quotes
							"order_id": responseData.razorpayOrder.id, // Ensure orderId is not undefined
							"handler": function (response) {
								window.location.href = `/placeOrderInvoice?id=${responseData.id}`;
							},
							"theme": {
								"color": "#2300a3"
							}
						};

						
						var razorpayObject = new Razorpay(options);

						razorpayObject.on('payment.failed', function (response) {
							console.log("Payment Failed:", response);
							// alert("Payment Faileds");
							Swal.fire({
							icon: 'error',
							title: "Payment Faileds",
							text: 'Your order Payment Faileds',
							confirmButtonText: 'OK',
						})
							window.location.href = `/cancelRazorpay?id=${responseData.id}`;
						});

						razorpayObject.open();
						// 2

					} else {
						Swal.fire({
							icon: 'success',
							title: 'Order Placed!',
							text: 'Your order has been placed successfully.',
							confirmButtonText: 'View Orders',
						}).then((result1) => {
							if (result1.isConfirmed) {
								window.location.href = `/placeOrderInvoice?id=${responseData.id}`;
							}
						});
					}

				} catch (error) {
					console.error('Error placing order:', error);
					Swal.fire({
						icon: 'error',
						title: 'Order Failed',
						text: error.message || 'An error occurred while placing your order',
						confirmButtonText: 'OK'
					});
				}
			});
		})

	</script>

	<!-- apply coupon show modal -->

	<script>
        document.getElementById("showCoupons").addEventListener("click", function() {
            fetch("/checkout")
                .then(response => response.json())
                .then(data => {
                    let couponList = document.getElementById("couponList");
                    couponList.innerHTML = "";
                    
                    data.forEach(coupon => {
                        let li = document.createElement("li");
                        li.textContent = coupon.code;

                        let copyBtn = document.createElement("button");
                        copyBtn.textContent = "Copy";
                        copyBtn.classList.add("copy-btn");

                        // Copy functionality
                        copyBtn.onclick = function() {
                            navigator.clipboard.writeText(coupon.code);
                            alert("Copied: " + coupon.code);
                        };

                        li.appendChild(copyBtn);
                        couponList.appendChild(li);
                    });

                    document.getElementById("couponModal").style.display = "block";
                    document.getElementById("overlay").style.display = "block";
                });
        });

        function closeModal() {
            document.getElementById("couponModal").style.display = "none";
            document.getElementById("overlay").style.display = "none";
        }
    </script>


</body>

</html>