<!DOCTYPE html>
<!-- =========================================================
* Redolence - Bootstrap Material Design Admin Template | v2.0.1
==============================================================

* Product Page: https://themeselection.com/item/Redolance-bootstrap-html-admin-template/
* Created by: ThemeSelection
* License: You must have a valid license purchased in order to legally use the theme for your project.
* Copyright ThemeSelection (https://themeselection.com)

=========================================================
-->

<html lang="en" class="light-style layout-navbar-fixed layout-menu-fixed layout-compact" dir="ltr" data-theme="theme-default" data-assets-path="../../admin/assets/" data-template="vertical-menu-template" data-style="light">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
    <title>Order List - Pages | Redolance - Bootstrap Material Design Admin Template</title>
    <meta name="description" content="Start your development with a Dashboard for Bootstrap 5" />
    <meta name="keywords" content="dashboard, material, material design, bootstrap 5 dashboard, bootstrap 5 design, bootstrap 5">
    <link rel="canonical" href="https://themeselection.com/item/Redolance-bootstrap-html-admin-template/" />
    <link rel="icon" type="image/x-icon" href="https://demos.themeselection.com/Redolence-bootstrap-html-admin-template/admin/assets/img/favicon/favicon.ico" />
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com/" />
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

    <!-- Icons -->
    <link rel="stylesheet" href="../../admin/assets/vendor/fonts/remixicon/remixicon.css" />
    <link rel="stylesheet" href="../../admin/assets/vendor/fonts/flag-icons.css" />
    
    <!-- Menu waves for no-customizer fix -->
    <link rel="stylesheet" href="../../admin/assets/vendor/libs/node-waves/node-waves.css" />

    <!-- Core CSS -->
    <link rel="stylesheet" href="../../admin/assets/vendor/css/rtl/core.css" class="template-customizer-core-css" />
    <link rel="stylesheet" href="../../admin/assets/vendor/css/rtl/theme-default.css" class="template-customizer-theme-css" />
    <link rel="stylesheet" href="../../admin/assets/css/demo.css" />
    
    <!-- Vendors CSS -->
    <link rel="stylesheet" href="../../admin/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css" />
    <link rel="stylesheet" href="../../admin/assets/vendor/libs/typeahead-js/typeahead.css" /> 
    <link rel="stylesheet" href="../../admin/assets/vendor/libs/datatables-bs5/datatables.bootstrap5.css" />
    <link rel="stylesheet" href="../../admin/assets/vendor/libs/datatables-responsive-bs5/responsive.bootstrap5.css" />
    <link rel="stylesheet" href="../../admin/assets/vendor/libs/datatables-buttons-bs5/buttons.bootstrap5.css" />
    <link rel="stylesheet" href="../../admin/assets/vendor/libs/datatables-checkboxes-jquery/datatables.checkboxes.css" />
    <link rel="stylesheet" href="../../admin/assets/vendor/libs/select2/select2.css" />
    <link rel="stylesheet" href="../../admin/assets/vendor/libs/%40form-validation/form-validation.css" />
    
    <!-- Helpers -->
    <script src="../../admin/assets/vendor/js/helpers.js"></script>
    <script src="../../admin/assets/vendor/js/template-customizer.js"></script>
    <script src="../../admin/assets/js/config.js"></script>
</head>

<body class="container mt-5" style="padding-left: 8.5rem;">

    <!-- Layout wrapper -->
    <div class="layout-wrapper layout-content-navbar">
        <div class="layout-container">
            <!-- Menu -->
            <aside id="layout-menu" class="layout-menu menu-vertical menu bg-menu-theme">
                <div class="menu-inner-shadow"></div>
                <ul class="menu-inner py-1">
                    <li class="menu-item active open">
                        <a href="javascript:void(0);" class="menu-link menu-toggle">
                            <i class='menu-icon tf-icons ri-shopping-bag-3-line'></i>
                            <div data-i18n="REDOLANCE">REDOLANCE</div>
                        </a>
                        <ul class="menu-sub">
                            <li class="menu-item">
                                <a href="/admin/dashboard" class="menu-link">
                                    <div data-i18n="Dashboard">Dashboard</div>
                                </a>
                            </li>
                            <li class="menu-item">
                                <a href="javascript:void(0);" class="menu-link menu-toggle">
                                    <div data-i18n="Products">Products</div>
                                </a>
                                <ul class="menu-sub">
                                    <li class="menu-item">
                                        <a href="/admin/productList" class="menu-link">
                                            <div data-i18n="Product List">Product List</div>
                                        </a>
                                    </li>
                                    <li class="menu-item">
                                        <a href="/admin/addProduct" class="menu-link">
                                            <div data-i18n="Add Product">Add Product</div>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li class="menu-item">
                                <a href="javascript:void(0);" class="menu-link menu-toggle">
                                    <div data-i18n="Category">Category</div>
                                </a>
                                <ul class="menu-sub">
                                    <li class="menu-item">
                                        <a href="/admin/category" class="menu-link">
                                            <div data-i18n="List all category">List all category</div>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li class="menu-item">
                                <a href="javascript:void(0);" class="menu-link menu-toggle">
                                    <div data-i18n="Users">Users</div>
                                </a>
                                <ul class="menu-sub">
                                    <li class="menu-item">
                                        <a href="/admin/userList" class="menu-link">
                                            <div data-i18n="Users list">Users list</div>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li class="menu-item">
                                <a href="javascript:void(0);" class="menu-link menu-toggle">
                                    <div data-i18n="Orders">Orders</div>
                                </a>
                                <ul class="menu-sub">
                                    <li class="menu-item">
                                        <a href="/admin/orderList" class="menu-link">
                                            <div data-i18n="Order list">Order list</div>
                                        </a>
                                    </li>
                                </ul>
                                <ul class="menu-sub">
                                    <li class="menu-item">
                                      <a href="/admin/orderList" class="menu-link">
                                        <div data-i18n="Order Details">Order Details</div>
                                      </a>
                                    </li>
                                </ul>
                                <li class="menu-item">
                                    <a href="javascript:void(0);" class="menu-link menu-toggle">
                                      <div data-i18n="Coupons Management">Coupons Management</div>
                                    </a>
                                    <ul class="menu-sub">
                                      <li class="menu-item">
                                        <a href="#" class="menu-link">
                                          <div data-i18n="Coupons">Coupons</div>
                                        </a>
                                      </li>
                                    </ul>
                                    <li class="menu-item active">
                                      <a href="javascript:void(0);" class="menu-link menu-toggle">
                                        <div data-i18n="Offers Management">Offers</div>
                                      </a>
                                      <ul class="menu-sub">
                                        <li class="menu-item">
                                                <a href="/admin/productOffers" class="menu-link">
                                                  <div data-i18n="Product Offers">Product Offers</div>
                                                </a>
                                              </li>
                                              <li class="menu-item active">
                                                <a href="/admin/categoryOffers" class="menu-link">
                                                  <div data-i18n="Category Offers">Category Offers</div>
                                                </a>
                                              </li>
                                              <li class="menu-item">
                                                <a href="/admin/referralOffers" class="menu-link">
                                                  <div data-i18n="Referral Offers">Referral Offers</div>
                                                </a>
                                              </li>
                                            </li>
                                        </ul>
                                    </li>
                                    <li class="menu-item">
                                        <a href="javascript:void(0);" class="menu-link menu-toggle">
                                          <div data-i18n="Sales">Sales</div>
                                        </a>
                                        <ul class="menu-sub">
                                          <li class="menu-item">
                                            <a href="/admin/salesReport" class="menu-link">
                                              <div data-i18n="SalesReport">SalesReport</div>
                                            </a>
                                          </li>
                                        </li>
                                </ul>
                                
                            </aside>                
                            <div class="container-xxl flex-grow-1 container-p-y" style="padding-left: 146px;" >
                                <h4 class="py-3 mb-4">Category Offers</h4>
                                
                                <!-- Add Offer Button -->
                                <div class="mb-4">
                                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addOfferModal">
                                        <i class="ri-add-line me-1"></i> Add Offer
                                    </button>
                                </div>
                        
                                <!-- Offers DataTable -->
                                <div class="card">
                                    <div class="card-datatable table-responsive">
                                        <table class="datatables-offers table" id="offersTable">
                                            <thead>
                                                <tr>
                                                    <th>Offer Title</th>
                                                    <th>Description</th>
                                                    <th>Discount</th>
                                                    <th>Category</th>
                                                    <th>Start Date</th>
                                                    <th>End Date</th>
                                                    <th>Status</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <!-- Data will be populated dynamically -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        
                            <!-- Add Offer Modal -->
                            <div class="modal fade" id="addOfferModal" tabindex="-1" aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered modal-lg">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Add Category Offer</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <form id="addOfferForm" class="needs-validation" novalidate>
                                            <div class="modal-body">
                                                <div class="row">
                                                    <div class="col-md-6 mb-3">
                                                        <input type="hidden" name="offerType" value="category">
                                                        <label class="form-label">Offer Type</label>
                                                        <input type="text" class="form-control" value="Category Offer" readonly>
                                                      </div>
                                                </div>

                                                    <div class="col-md-6 mb-3">
                                                        <label class="form-label">Offer Title</label>
                                                        <input type="text" class="form-control" name="offerTitle" required>
                                                        <div class="invalid-feedback">Please enter an offer title.</div>
                                                    </div>
                                                    <div class="col-md-6 mb-3">
                                                        <label class="form-label">Category</label>
                                                        <select class="form-select" name="applicableProduct" required>
                                                            <!-- Categories will be populated dynamically -->
                                                        </select>
                                                        <div class="invalid-feedback">Please select a category.</div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-12 mb-3">
                                                        <label class="form-label">Offer Description</label>
                                                        <textarea class="form-control" name="offerDescription" required></textarea>
                                                        <div class="invalid-feedback">Please enter an offer description.</div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-4 mb-3">
                                                        <label class="form-label">Discount Type</label>
                                                        <select class="form-select" name="discountType" required>
                                                            <option value="percentage">Percentage</option>
                                                            <option value="flat">Flat Amount</option>
                                                        </select>
                                                        <div class="invalid-feedback">Please select a discount type.</div>
                                                    </div>
                                                    <div class="col-md-4 mb-3">
                                                        <label class="form-label">Discount Value</label>
                                                        <input type="number" class="form-control" name="discountValue" required min="0">
                                                        <div class="invalid-feedback">Please enter a valid discount value.</div>
                                                    </div>
                                                    <div class="col-md-4 mb-3">
                                                        <label class="form-label">Min. Purchase Amount</label>
                                                        <input type="number" class="form-control" name="minPurchaseAmount" required min="0">
                                                        <div class="invalid-feedback">Please enter a minimum purchase amount.</div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <label class="form-label">Start Date</label>
                                                        <input type="date" class="form-control" name="startDate" required>
                                                        <div class="invalid-feedback">Please select start date</div>
                                                    </div>
    
                                                    <div class="col-md-6">
                                                        <label class="form-label">End Date</label>
                                                        <input type="date" class="form-control" name="expireDate" required>
                                                        <div class="invalid-feedback">Please select end date</div>
                                                    </div>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
                                                    <button type="submit" class="btn btn-primary">Save Offer</button>
                                                </div>
                                            </div>
                                            
                                        </form>
                                    </div>
                                </div>
                            </div>
                
            </div>
        </div>
    </div>
</div>
                
                   

    <!-- Overlay -->
    <div class="layout-overlay layout-menu-toggle"></div>
    <!-- Drag Target Area To SlideIn Menu On Small Screens -->
    <div class="drag-target"></div>
</div>
<!-- / Layout wrapper -->

<!-- Core JS -->
<script src="../../admin/assets/vendor/libs/jquery/jquery.js"></script>
<script src="../../admin/assets/vendor/libs/popper/popper.js"></script>
<script src="../../admin/assets/vendor/js/bootstrap.js"></script>
<script src="../../admin/assets/vendor/libs/node-waves/node-waves.js"></script>
<script src="../../admin/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js"></script>
<script src="../../admin/assets/vendor/libs/hammer/hammer.js"></script>
<script src="../../admin/assets/vendor/libs/i18n/i18n.js"></script>
<script src="../../admin/assets/vendor/libs/typeahead-js/typeahead.js"></script>
<script src="../../admin/assets/vendor/js/menu.js"></script>

<!-- Vendors JS -->
<script src="../../admin/assets/vendor/libs/moment/moment.js"></script>
<script src="../../admin/assets/vendor/libs/datatables-bs5/datatables-bootstrap5.js"></script>
<script src="../../admin/assets/vendor/libs/select2/select2.js"></script>
<script src="../../admin/assets/vendor/libs/%40form-validation/popular.js"></script>
<script src="../../admin/assets/vendor/libs/%40form-validation/bootstrap5.js"></script>
<script src="../../admin/assets/vendor/libs/%40form-validation/auto-focus.js"></script>
<script src="../../admin/assets/vendor/libs/cleavejs/cleave.js"></script>
<script src="../../admin/assets/vendor/libs/cleavejs/cleave-phone.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<!-- Main JS -->
<script src="../../admin/assets/js/main.js"></script>

<script>
   document.addEventListener('DOMContentLoaded', function() {
    const offersTable = $('#offersTable').DataTable({
        ajax: '/admin/api/categoryOffers',
        columns: [
            { data: 'offerTitle' },
            { data: 'offerDescription' },
            { 
                data: null,
                render: function(data) {
                    return data.discountType === 'percentage' 
                        ? `${data.discountValue}%` 
                        : `â‚¹${data.discountValue}`;
                }
            },
            { data: 'applicableProduct.name' },
            { 
                data: 'startDate',
                render: function(data) {
                    return moment(data).format('DD/MM/YYYY');
                }
            },
            { 
                data: 'expireDate',
                render: function(data) {
                    return moment(data).format('DD/MM/YYYY');
                }
            },
            { 
                data: 'status',
                render: function(data) {
                    const statusClasses = {
                        active: 'bg-success',
                        expired: 'bg-danger',
                        upcoming: 'bg-warning'
                    };
                    return `<span class="badge ${statusClasses[data]}">${data}</span>`;
                }
            },
            {
                data: null,
                render: function(data) {
                    return `
                        <div class="d-inline-block">
                            <button class="btn btn-sm btn-icon edit-offer" data-id="${data._id}">
                                <i class="ri-pencil-line"></i>
                            </button>
                            <button class="btn btn-sm btn-icon delete-offer" data-id="${data._id}">
                                <i class="ri-delete-bin-line"></i>
                            </button>
                        </div>
                    `;
                }
            }
        ]
    });

    // Form Validation and Submission
    const form = document.getElementById('addOfferForm');
    const modal = new bootstrap.Modal(document.getElementById('addOfferModal'));
    
    form.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        if (!form.checkValidity()) {
            e.stopPropagation();
            form.classList.add('was-validated');
            return;
        }

        const formData = new FormData(form);
        const data = Object.fromEntries(formData.entries());

        try {
            const response = await fetch('/admin/api/categoryOffers', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            });

            if (!response.ok) {
                throw new Error('Failed to save offer');
            }

            // Hide modal properly
            modal.hide();
            // Remove modal backdrop manually if it persists
            const modalBackdrop = document.querySelector('.modal-backdrop');
            if (modalBackdrop) {
                modalBackdrop.remove();
            }
            // Remove modal-open class from body
            document.body.classList.remove('modal-open');
            document.body.style.overflow = '';
            document.body.style.paddingRight = '';

            // Reset form and refresh table
            form.reset();
            form.classList.remove('was-validated');
            offersTable.ajax.reload();
            
            // Show success message
            Swal.fire({
                icon: 'success',
                title: 'Success',
                text: 'Offer has been created successfully!'
            });
        } catch (error) {
            console.error('Error:', error);
            Swal.fire({
                icon: 'error',
                title: 'Error',
                text: 'Failed to create offer. Please try again.'
            });
        }
    });

    
    // Modal hidden event handler
    $('#addOfferModal').on('hidden.bs.modal', function () {
        // Reset form and remove offer ID
        form.reset();
        form.classList.remove('was-validated');
        delete form.dataset.offerId;
        form.dataset.mode = 'add';
    });

    // Load Categories for Select
    async function loadCategories() {
        try {
            const response = await fetch('/admin/api/categories');
            const categories = await response.json();
            
            const select = document.querySelector('select[name="applicableProduct"]');
            categories.forEach(category => {
                const option = new Option(category.name, category._id);
                select.add(option);
            });
        } catch (error) {
            console.error('Error loading categories:', error);
        }
    }

    loadCategories();
});
</script>


<script>
    // Add edit functionality
$(document).on('click', '.edit-offer', async function() {
    const offerId = $(this).data('id');
    try {
        const response = await fetch(`/admin/api/categoryOffers/${offerId}`);
        const offer = await response.json();
        
        // Populate form
        const form = document.getElementById('addOfferForm');
        form.dataset.offerId = offerId;
        form.dataset.mode = 'edit';
        form.querySelector('[name="offerTitle"]').value = offer.offerTitle;
        form.querySelector('[name="offerDescription"]').value = offer.offerDescription;
        form.querySelector('[name="discountType"]').value = offer.discountType;
        form.querySelector('[name="discountValue"]').value = offer.discountValue;
        form.querySelector('[name="minPurchaseAmount"]').value = offer.minPurchaseAmount;
        form.querySelector('[name="applicableProduct"]').value = offer.applicableProduct._id;
        form.querySelector('[name="startDate"]').value = moment(offer.startDate).format('YYYY-MM-DD');
        form.querySelector('[name="expireDate"]').value = moment(offer.expireDate).format('YYYY-MM-DD');
        
        // Update modal title
        document.querySelector('#addOfferModal .modal-title').textContent = 'Edit Category Offer';
        const modal = new bootstrap.Modal(document.getElementById('addOfferModal'));
        modal.show();
    } catch (error) {
        console.error('Error fetching offer:', error);
        Swal.fire('Error', 'Could not load offer details', 'error');
    }
});

// Add delete functionality
$(document).on('click', '.delete-offer', function() {
    const offerId = $(this).data('id');
    Swal.fire({
        title: 'Are you sure?',
        text: "You won't be able to revert this!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Yes, delete it!'
    }).then(async (result) => {
        if (result.isConfirmed) {
            try {
                const response = await fetch(`/admin/api/categoryOffers/${offerId}`, {
                    method: 'DELETE'
                });
                
                if (!response.ok) throw new Error('Delete failed');
                
                offersTable.ajax.reload();
                Swal.fire('Deleted!', 'The offer has been deleted.', 'success');
            } catch (error) {
                console.error('Delete error:', error);
                Swal.fire('Error', 'Failed to delete offer', 'error');
            }
        }
    });
});

// Modify form submission handler to handle both create and update
form.addEventListener('submit', async function(e) {
    e.preventDefault();
    
    if (!form.checkValidity()) {
        e.stopPropagation();
        form.classList.add('was-validated');
        return;
    }

    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    const offerId = form.dataset.offerId; // Get the offer ID from the dataset
    const isEdit = !!offerId; // Check if we're in edit mode

    try {
        const url = isEdit ? `/admin/api/categoryOffers/${offerId}` : '/admin/api/categoryOffers';
        const method = isEdit ? 'PUT' : 'POST'; // Use PUT for editing

        const response = await fetch(url, {
            method: method,
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data)
        });

        if (!response.ok) {
            throw new Error(isEdit ? 'Failed to update offer' : 'Failed to save offer');
        }

        // Hide modal and reset form
        const modal = bootstrap.Modal.getInstance(document.getElementById('addOfferModal'));
        if (modal) {
            modal.hide();
        }
        form.reset();
        form.classList.remove('was-validated');
        delete form.dataset.offerId; // Clear the offer ID
        offersTable.ajax.reload(); // Refresh the table
        
        Swal.fire({
            icon: 'success',
            title: 'Success',
            text: isEdit ? 'Offer updated successfully!' : 'Offer created successfully!'
        });
    } catch (error) {
        console.error('Error:', error);
        Swal.fire({
            icon: 'error',
            title: 'Error',
            text: error.message
        });
    }
});
</script>
<script>
    // Add event listener for edit buttons
$(document).on('click', '.edit-offer', async function() {
    const offerId = $(this).data('id');
    try {
        const response = await fetch(`/admin/api/categoryOffers/${offerId}`);
        const offer = await response.json();
        
        const form = document.getElementById('addOfferForm');
        form.dataset.offerId = offerId;
        form.dataset.mode = 'edit';
        
        // Populate form fields
        form.elements.offerTitle.value = offer.offerTitle;
        form.elements.offerDescription.value = offer.offerDescription;
        form.elements.discountType.value = offer.discountType;
        form.elements.discountValue.value = offer.discountValue;
        form.elements.minPurchaseAmount.value = offer.minPurchaseAmount || '';
        form.elements.startDate.value = moment(offer.startDate).format('YYYY-MM-DD');
        form.elements.expireDate.value = moment(offer.expireDate).format('YYYY-MM-DD');
        
        // Set category selection
        const categorySelect = form.elements.applicableProduct;
        categorySelect.value = offer.applicableProduct._id;
        
        $('#addOfferModal').modal('show');
    } catch (error) {
        Swal.fire('Error', 'Failed to load offer details.', 'error');
    }
});

// Update form submission handler
form.addEventListener('submit', async function(e) {
    e.preventDefault();
    
    if (!form.checkValidity()) {
        e.stopPropagation();
        form.classList.add('was-validated');
        return;
    }

    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());
    const offerId = form.dataset.offerId;
    const isEdit = form.dataset.mode === 'edit';

    try {
        const url = isEdit ? `/admin/api/categoryOffers/${offerId}` : '/admin/api/categoryOffers';
        const method = isEdit ? 'PUT' : 'POST';

        const response = await fetch(url, {
            method: method,
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });

        if (!response.ok) throw new Error('Request failed');

        modal.hide();
        document.body.classList.remove('modal-open');
        const modalBackdrop = document.querySelector('.modal-backdrop');
        if (modalBackdrop) modalBackdrop.remove();

        form.reset();
        form.classList.remove('was-validated');
        delete form.dataset.offerId;
        delete form.dataset.mode;
        
        offersTable.ajax.reload();
        
        Swal.fire({
            icon: 'success',
            title: `Offer ${isEdit ? 'Updated' : 'Created'}!`,
            text: `Offer has been ${isEdit ? 'updated' : 'created'} successfully.`
        });
    } catch (error) {
        Swal.fire({
            icon: 'error',
            title: 'Error',
            text: error.message || 'Operation failed. Please try again.'
        });
    }
});
</script>
<script>
    // Delete offer handler
$(document).on('click', '.delete-offer', function() {
    const offerId = $(this).data('id');
    Swal.fire({
        title: 'Are you sure?',
        text: "You won't be able to revert this!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Yes, delete it!'
    }).then(async (result) => {
        if (result.isConfirmed) {
            try {
                await fetch(`/admin/api/categoryOffers/${offerId}`, { method: 'DELETE' });
                offersTable.ajax.reload();
                Swal.fire('Deleted!', 'Offer has been deleted.', 'success');
            } catch (error) {
                Swal.fire('Error!', 'Deletion failed.', 'error');
            }
        }
    });
});
</script>
</body>
</html>